function dC = Jacobi_const_diff_CR3BP(x,mu)
% differrential of Jacobi Integral

% dC = [2*(x(1)+(-1)*mu*((-1)+mu+x(1))*(((-1)+mu+x(1))^2+x(2)^2+x(3)^2)^(-3/2)+((-1)+mu)*(mu+x(1))*((mu+x(1))^2+x(2)^2+x(3)^2)^(-3/2));
%   2*(x(2)+(-1)*mu*x(2)*(((-1)+mu+x(1))^2+x(2)^2+x(3)^2)^(-3/2)+((-1)+mu)*x(2)*((mu+x(1))^2+x(2)^2+x(3)^2)^(-3/2));
%   (-2)*mu*x(3)*(((-1)+mu+x(1))^2+x(2)^2+x(3)^2)^(-3/2)+2*((-1)+mu)*x(3)*((mu+x(1))^2+x(2)^2+x(3)^2)^(-3/2);
%   (-2)*x(4);
%   (-2)*x(5);
%   (-2)*x(6)];
%the distances
r1 = sqrt((mu+x(1))^2+(x(2))^2+(x(3))^2);
r2 = sqrt((x(1)-1+mu)^2+(x(2))^2+(x(3))^2);

 dC = [2*(x(1) - (1-mu)*(x(1)+mu)/r1^3 - mu*(x(1)-1+mu)/r2^3); % 2*dU/dx
       2*(x(2) -      (1-mu)*x(2)/r1^3 -       mu*x(2)/r2^3);  % 2*dU/dy
       2*(     -      (1-mu)*x(3)/r1^3 -       mu*x(3)/r2^3);  % 2*dU/dz
       (-2)*x(4);
       (-2)*x(5);
       (-2)*x(6)];
end